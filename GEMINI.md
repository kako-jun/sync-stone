# SyncStone Chrome拡張機能

## 経緯

FF14の公式サービス「The Lodestone（ロドスト）」には、プレイヤーが日記を投稿する機能がある。しかし、この日記にはインポート/エクスポート機能が存在しない。

ユーザーはロドストに100記事以上のプレイ日記を書いており、将来的にFF14を引退する際にこれらの記事が失われることを懸念している。そのため、ロドストの日記をエクスポートするツールを開発したいと考えている。

### エクスポートの課題と解決策

1.  **API/Feedの不在**: ロドストには記事一覧や個別記事の閲覧URLは存在するが、記事内容を取得するためのAPIやRSS/Atom Feedは提供されていない。
2.  **プレーンテキストでのエクスポートの要望**: 閲覧画面から記事内容を取得すると、ロドスト独自の記法や画像、リンクの埋め込みが含まれてしまう。理想としては、編集画面で表示されるような「素のプレーンテキスト」をエクスポートしたい。
3.  **ログインとセキュリティの懸念**: 編集画面はログインが必要であり、ツールにユーザーのロドストIDとパスワードを直接入力させる方法は、セキュリティ上の抵抗感がある。ユーザーがコードを全て読まない限り、安心して使えないツールになってしまう。

### Chrome拡張機能としての開発

上記の課題を解決するため、Chrome拡張機能として開発する方針が決定された。

*   **ログインセッションの利用**: ユーザーがブラウザでロドストにログイン済みの状態から拡張機能を起動する。これにより、拡張機能はユーザーのログインセッションを利用してロドストにアクセスできる。
*   **編集画面からのデータ取得**: 拡張機能は、ログイン済みのセッションを利用して各記事の編集画面にアクセスし、そこからプレーンテキスト形式の記事内容を取得する。
*   **サーバー負荷への配慮**: 記事のクロールは、サーバーに過度な負荷をかけないよう、人間が操作する程度の速度で行う。
*   **取得データの格納**: 取得したプレーンテキストは、一時的に配列に格納される。

## 仕様概要

SyncStoneは「星紡のメモワール」と名付けられ、Chrome拡張機能単体で動作する。

### 1. 機能概要

*   **全記事エクスポート**: ロドストの日記一覧ページから、すべての記事のタイトル、本文、画像、埋め込みリンク、コメント数、いいね数を取得し、Markdown形式に変換してZIPファイルとしてダウンロードする。
*   **現在の記事エクスポート**: 現在開いているロドストの日記個別記事ページ、または日記編集ページから、記事のタイトル、本文、画像、埋め込みリンク、コメント数、いいね数を取得し、Markdown形式に変換して個別のMarkdownファイルとしてダウンロードする。

### 2. エクスポートされる情報

*   記事本文 (Markdown形式)
*   記事タイトル
*   画像 (Markdownの画像リンクとして埋め込み)
*   埋め込みリンク (Markdownのリンクとして埋め込み)
*   コメント数
*   いいね数

### 3. 技術スタック

*   **Chrome拡張機能**: JavaScript
*   **HTML to Markdown変換**: Turndownライブラリ
*   **ZIPファイル生成**: JSZipライブラリ

### 4. サーバー負荷への配慮

*   記事のクロールは、サーバーに過度な負荷をかけないよう、人間が操作する程度の速度で行う（記事間の待機時間を設ける）。

### 5. 削除機能の非搭載

*   **コンセプト**: 「SyncStone ― 星紡のメモワール」として、記憶の保存・復元はできても「消す」機能は持たない。
*   **理由**:
    *   安全性の確保（誤操作やマルウェア的な振る舞いの防止）。
    *   記憶の尊重（「過去に紡いだものは、簡単には失われない」という思想）。
    *   ユーザー主導（削除したければユーザー自身がファイルを管理）。
    *   設計哲学との合致（ツールの役割は「忘れない」こと、「失われかけた灯を編む」こと）。

### 6. 全体コンセプト

*   SyncStoneは「ロドストの日記をローカルに保存し、思い出として残す」ことを目的とする。
*   「星を紡ぐ」行為をロドストからローカル環境へ移行し、ユーザーが自由に管理できるようにする。
*   ロドストは「記録の納所」、SyncStoneは「その記録をローカルへ移す橋」となる。